### ELK 스택(Elasticsearch + Logstash + Kibana)을 활용한 로그 데이터 수집, 분석, 시각화 방법과 오픈소스 여부

#### **1. ELK 스택 개요**
ELK 스택은 **Elasticsearch**, **Logstash**, **Kibana** 세 가지 오픈소스 도구로 구성된 로그 관리 플랫폼입니다.  
- **Elasticsearch**: 분산 검색 및 분석 엔진 (JSON 기반의 NoSQL 데이터베이스).  
- **Logstash**: 데이터 수집, 변환, 전송 파이프라인 (다양한 소스에서 데이터를 처리).  
- **Kibana**: 데이터 시각화 및 대시보드 도구.  

#### **2. 로그 데이터 처리 단계별 방법**

##### **(1) 로그 수집 (Logstash)**
- **입력(Input)**: 파일, 데이터베이스, API, Syslog, Beats(Filebeat, Metricbeat) 등 다양한 소스에서 로그 수집.  
  ```conf
  # Logstash 설정 예시 (파일 입력)
  input {
    file {
      path => "/var/log/nginx/access.log"
      start_position => "beginning"
    }
  }
  ```
- **필터(Filter)**: Grok 패턴으로 로그 파싱, 필드 추가/삭제, 데이터 정제.  
  ```conf
  filter {
    grok {
      match => { "message" => "%{COMBINEDAPACHELOG}" }
    }
    date {
      match => [ "timestamp", "dd/MMM/yyyy:HH:mm:ss Z" ]
    }
  }
  ```
- **출력(Output)**: 처리된 데이터를 Elasticsearch로 전송.  
  ```conf
  output {
    elasticsearch {
      hosts => ["http://localhost:9200"]
      index => "nginx-logs-%{+YYYY.MM.dd}"
    }
  }
  ```

##### **(2) 데이터 저장 및 분석 (Elasticsearch)**
- **인덱스 생성**: 로그 데이터는 자동으로 인덱스되며, RESTful API로 검색/분석 가능.  
  ```sh
  # 예시: 인덱스 조회
  curl -X GET "localhost:9200/_cat/indices?v"
  ```
- **쿼리**: 풀텍스트 검색, 집계(Aggregation)를 통한 통계 분석.  
  ```json
  {
    "query": { "match": { "response": "200" } },
    "aggs": { "avg_response_time": { "avg": { "field": "response_time" } } }
  }
  ```

##### **(3) 시각화 (Kibana)**
- **대시보드 생성**:  
  1. Kibana에서 `Discover` 탭으로 로그 탐색.  
  2. `Visualize`에서 차트(막대, 원형, 지도 등) 생성.  
  3. `Dashboard`에 시각화 요소를 조합해 실시간 모니터링.  
- **예시**:  
  - Nginx 접속 로그의 지리적 분포 (GeoIP 플러그인 활용).  
  - 시간별 에러 로그 추이 (히스토그램).  

#### **3. 오픈소스 여부**
- **기본 구성**:  
  - Elasticsearch, Logstash, Kibana의 **기본 버전은 오픈소스** (Apache 2.0 라이선스).  
- **상용 버전**:  
  - Elastic社에서 제공하는 **X-Pack** 플러그인(보안, 모니터링, 머신러닝 등)은 **유료**.  
  - 오픈소스 버전과의 차이점:  
    | 기능          | 오픈소스 버전 | 상용 버전 (X-Pack 포함) |  
    |---------------|--------------|------------------------|  
    | 보안(인증/암호화) | ❌ 없음      | ✅ 지원                |  
    | 알림          | ❌ 없음      | ✅ Slack/이메일 연동   |  
    | 머신러닝      | ❌ 없음      | ✅ 이상 감지 자동화    |  

#### **4. 무료 대안 및 확장 도구**
- **Beats**: 경량 데이터 수집기 (Filebeat, Metricbeat 등)로 Logstash 대체 가능.  
- **OpenSearch**: Elasticsearch의 포크(fork) 버전으로 100% 오픈소스 (AWS 주도).  

#### **5. 결론**
- **순수 오픈소스 ELK**로도 로그 수집부터 시각화까지 가능하지만, 고급 기능(보안 등)은 유료 라이선스 필요.  
- **학습/소규모 환경**에서는 무료 버전으로 충분하며, **기업용**은 X-Pack 또는 OpenSearch 고려.  

> 참고: 최신 라이선스 정책은 [Elastic 공식 문서](https://www.elastic.co/kr/subscriptions)에서 확인 필요.