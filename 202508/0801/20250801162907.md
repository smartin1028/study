# 엘라스틱서치(Elasticsearch) 사용자 생성 방법

엘라스틱서치에서 사용자를 생성하는 방법은 다음과 같습니다. 엘라스틱서치는 기본적으로 보안 기능이 비활성화되어 있으므로, 먼저 보안 설정을 활성화해야 합니다.

## 1. 기본 보안 설정 활성화

1. `elasticsearch.yml` 파일 수정:
   ```yaml
   xpack.security.enabled: true
   xpack.security.transport.ssl.enabled: true
   ```

2. 엘라스틱서치 재시작 후 기본 사용자 비밀번호 설정:
   ```bash
   bin/elasticsearch-setup-passwords auto  # 자동 생성
   # 또는
   bin/elasticsearch-setup-passwords interactive  # 수동 입력
   ```

## 2. 사용자 생성 방법

### API를 통한 사용자 생성

```bash
curl -X POST "localhost:9200/_security/user/<username>" \
  -H "Content-Type: application/json" \
  -u elastic:your_elastic_password \
  -d '{
    "password": "user_password",
    "roles": ["role1", "role2"],
    "full_name": "User Full Name",
    "email": "user@example.com",
    "metadata": {
      "department": "engineering"
    }
  }'
```

### Kibana를 통한 사용자 생성

1. Kibana에 접속 (http://localhost:5601)
2. 좌측 메뉴에서 "Stack Management" 선택
3. "Security" > "Users" 클릭
4. "Create user" 버튼 클릭
5. 필요한 정보 입력:
   - Username
   - Password
   - Roles (할당할 역할 선택)
   - Full name
   - Email
   - Metadata (선택 사항)

## 3. 사용자 속성 설명

- **username**: 사용자 식별자 (필수)
- **password**: 사용자 비밀번호 (필수)
- **roles**: 사용자에게 할당할 역할 목록
- **full_name**: 사용자 전체 이름 (선택 사항)
- **email**: 사용자 이메일 (선택 사항)
- **metadata**: 추가 메타데이터 (선택 사항)

## 4. 사용자 관리 명령어

### 사용자 조회
```bash
curl -X GET "localhost:9200/_security/user/<username>" \
  -u elastic:your_elastic_password
```

### 사용자 삭제
```bash
curl -X DELETE "localhost:9200/_security/user/<username>" \
  -u elastic:your_elastic_password
```

### 사용자 비밀번호 변경
```bash
curl -X POST "localhost:9200/_security/user/<username>/_password" \
  -H "Content-Type: application/json" \
  -u elastic:your_elastic_password \
  -d '{
    "password": "new_password"
  }'
```

## 5. 권장 사항

1. 기본 `elastic` 사용자는 관리 용도로만 사용하고, 일반 작업에는 별도 사용자 생성 권장
2. 최소 권한 원칙 적용 - 사용자에게 필요한 최소한의 권한만 부여
3. 정기적으로 비밀번호 변경
4. 역할 기반 접근 제어(RBAC) 구현

엘라스틱서치 버전에 따라 명령어나 설정 방법이 약간 다를 수 있으므로, 사용 중인 버전의 공식 문서를 참조하는 것이 좋습니다.