# 엘라스틱서치(Elasticsearch) 개요 및 구현 방법

## 엘라스틱서치란?

엘라스틱서치(Elasticsearch)는 **오픈소스 분산 검색 및 분석 엔진**으로, 다음과 같은 특징을 가집니다:

1. **실시간 검색 기능**: 데이터가 입력되면 거의 실시간으로 검색 가능
2. **분산 아키텍처**: 수평 확장이 용이하여 대용량 데이터 처리 가능
3. **RESTful API**: HTTP 기반의 간단한 인터페이스 제공
4. **다양한 데이터 유형 지원**: 텍스트, 숫자, 지리 공간 데이터 등
5. **Apache Lucene 기반**: 고성능 텍스트 검색 엔진

주요 사용 사례:
- 애플리케이션 검색 기능
- 로그 및 이벤트 데이터 분석(ELK 스택의 일부)
- 비즈니스 인텔리전스
- 지능형 추천 시스템

## 엘라스틱서치 구현 방법

### 1. 기본 설치 및 설정

**1.1 시스템 요구사항 확인**
- Java 8 이상 설치 필요
- 메모리: 최소 2GB(프로덕션은 8GB 이상 권장)

**1.2 설치 방법 (Ubuntu 예시)**
```bash
# Elasticsearch 공개 키 추가
wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add -

# 저장소 추가
sudo apt-get install apt-transport-https
echo "deb https://artifacts.elastic.co/packages/7.x/apt stable main" | sudo tee -a /etc/apt/sources.list.d/elastic-7.x.list

# 설치
sudo apt-get update && sudo apt-get install elasticsearch
```

**1.3 기본 구성 파일 수정 (`/etc/elasticsearch/elasticsearch.yml`)**
```yaml
cluster.name: my-application
node.name: node-1
network.host: 0.0.0.0
http.port: 9200
discovery.seed_hosts: ["host1", "host2"]
cluster.initial_master_nodes: ["node-1"]
```

**1.4 서비스 시작**
```bash
sudo systemctl start elasticsearch
sudo systemctl enable elasticsearch
```

### 2. 인덱스 생성 및 데이터 입력

**2.1 인덱스 생성 (REST API 예시)**
```bash
curl -X PUT "localhost:9200/my_index?pretty" -H 'Content-Type: application/json' -d'
{
  "settings": {
    "number_of_shards": 3,
    "number_of_replicas": 2
  },
  "mappings": {
    "properties": {
      "title":    { "type": "text"  },
      "content":  { "type": "text"  },
      "date":     { "type": "date" },
      "views":    { "type": "integer" }
    }
  }
}
'
```

**2.2 문서 추가**
```bash
curl -X POST "localhost:9200/my_index/_doc/1?pretty" -H 'Content-Type: application/json' -d'
{
  "title": "Elasticsearch 소개",
  "content": "Elasticsearch는 분산 검색 엔진입니다.",
  "date": "2023-01-01",
  "views": 100
}
'
```

### 3. 검색 쿼리 실행

**3.1 기본 검색**
```bash
curl -X GET "localhost:9200/my_index/_search?pretty" -H 'Content-Type: application/json' -d'
{
  "query": {
    "match": {
      "content": "검색 엔진"
    }
  }
}
'
```

**3.2 복합 쿼리 예시**
```bash
curl -X GET "localhost:9200/my_index/_search?pretty" -H 'Content-Type: application/json' -d'
{
  "query": {
    "bool": {
      "must": [
        { "match": { "content": "엔진" } }
      ],
      "filter": [
        { "range": { "views": { "gte": 50 } } }
      ]
    }
  }
}
'
```

### 4. 클라이언트 연동 (Python 예시)

**4.1 Python 클라이언트 설치**
```bash
pip install elasticsearch
```

**4.2 기본 연동 코드**
```python
from elasticsearch import Elasticsearch

# 클라이언트 연결
es = Elasticsearch(["http://localhost:9200"])

# 인덱스 생성
es.indices.create(index="python_index", ignore=400)

# 문서 추가
doc = {
    "author": "kim",
    "text": "Elasticsearch는 강력한 검색 기능을 제공합니다.",
    "timestamp": "2023-01-01"
}
es.index(index="python_index", id=1, body=doc)

# 검색
result = es.search(index="python_index", body={"query": {"match": {"text": "검색"}}})
print(result)
```

### 5. 고급 구성 요소

1. **클러스터 구성**: 여러 노드로 구성하여 고가용성 확보
2. **샤딩 전략**: 데이터 분산을 위한 최적의 샤드 수 결정
3. **보안 설정**: X-Pack 또는 OpenDistro를 통한 인증/권한 부여
4. **성능 튜닝**: JVM 힙 크기 조정, 캐시 설정 최적화
5. **모니터링**: Kibana와 연동하여 시스템 상태 모니터링

## 주의사항

1. **메모리 관리**: JVM 힙 크기를 물리적 메모리의 50% 이하로 설정
2. **데이터 백업**: 스냅샷 기능을 활용한 정기 백업 필수
3. **버전 업그레이드**: 주요 버전 간 업그레이드 시 마이그레이션 가이드 준수
4. **보안**: 기본 보안 설정 변경(기본값은 보안이 해제된 상태)

엘라스틱서치는 다양한 프로그래밍 언어와 통합이 가능하며, 공식 문서와 커뮤니티 지원이 풍부해 학습 곡선이 비교적 완만합니다.