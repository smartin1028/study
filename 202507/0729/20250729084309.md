# Python에서 폴더 내 파일 목록 가져오기, 내부 폴더 접근 및 ZIP 파일 해제 방법

## 1. 특정 폴더 위치의 파일 목록 가져오기

Python에서는 `os` 모듈이나 `pathlib` 모듈을 사용하여 파일 목록을 가져올 수 있습니다.

### 방법 1: os 모듈 사용

```python
import os

# 특정 폴더 경로 지정
folder_path = '/path/to/your/folder'

# 폴더 내 모든 파일과 디렉토리 목록 가져오기
all_contents = os.listdir(folder_path)
print("모든 내용:", all_contents)

# 파일만 필터링하여 가져오기
files_only = [f for f in os.listdir(folder_path) 
              if os.path.isfile(os.path.join(folder_path, f))]
print("파일만:", files_only)

# 특정 확장자 파일만 가져오기 (예: .txt)
txt_files = [f for f in os.listdir(folder_path) 
             if f.endswith('.txt')]
print("텍스트 파일만:", txt_files)
```

### 방법 2: glob 모듈 사용 (패턴 매칭)

```python
import glob

# 모든 파일 가져오기
all_files = glob.glob('/path/to/your/folder/*')
print("모든 파일:", all_files)

# 특정 확장자 파일만 (예: .csv)
csv_files = glob.glob('/path/to/your/folder/*.csv')
print("CSV 파일:", csv_files)

# 하위 디렉토리 포함 모든 파일 검색 (재귀적)
all_files_recursive = glob.glob('/path/to/your/folder/**/*', recursive=True)
print("모든 파일 (재귀):", all_files_recursive)
```

### 방법 3: pathlib 모듈 사용 (Python 3.4+)

```python
from pathlib import Path

folder = Path('/path/to/your/folder')

# 모든 파일 가져오기
all_files = [f for f in folder.iterdir() if f.is_file()]
print("모든 파일:", all_files)

# 특정 패턴 파일 가져오기
py_files = list(folder.glob('*.py'))
print("Python 파일:", py_files)

# 재귀적으로 모든 파일 가져오기
all_files_recursive = list(folder.rglob('*'))
print("모든 파일 (재귀):", all_files_recursive)
```

## 2. 내부 폴더 접근 방법

### 재귀적으로 모든 하위 폴더 탐색

```python
import os

def list_files_recursive(startpath):
    for root, dirs, files in os.walk(startpath):
        print(f"현재 디렉토리: {root}")
        print(f"하위 디렉토리: {dirs}")
        print(f"파일들: {files}")
        print("-" * 40)

# 사용 예시
list_files_recursive('/path/to/your/folder')
```

### 특정 하위 폴더에 접근

```python
import os

base_path = '/path/to/your/folder'
subfolder = 'subfolder_name'

# 하위 폴더 경로 조합
subfolder_path = os.path.join(base_path, subfolder)

# 하위 폴더 존재 확인 후 접근
if os.path.exists(subfolder_path) and os.path.isdir(subfolder_path):
    files_in_subfolder = os.listdir(subfolder_path)
    print(f"{subfolder} 내 파일들:", files_in_subfolder)
else:
    print(f"{subfolder} 폴더가 존재하지 않습니다.")
```

## 3. ZIP 파일 해제 방법

Python에서는 `zipfile` 모듈을 사용하여 ZIP 파일을 해제할 수 있습니다.

### 기본적인 ZIP 파일 해제

```python
import zipfile
import os

zip_path = '/path/to/your/file.zip'
extract_dir = '/path/to/extract/folder'

# ZIP 파일 열기
with zipfile.ZipFile(zip_path, 'r') as zip_ref:
    # 모든 내용을 지정된 디렉토리에 압축 해제
    zip_ref.extractall(extract_dir)
    print(f"{zip_path} 파일이 {extract_dir}에 성공적으로 압축 해제되었습니다.")

    # ZIP 파일 내 파일 목록 확인
    print("ZIP 파일 내 내용:")
    for file_info in zip_ref.infolist():
        print(f"- {file_info.filename} (크기: {file_info.file_size} bytes)")
```

### 특정 파일만 선택적으로 해제

```python
import zipfile

zip_path = '/path/to/your/file.zip'
extract_dir = '/path/to/extract/folder'

with zipfile.ZipFile(zip_path, 'r') as zip_ref:
    # 특정 파일만 해제 (예: 'document.txt')
    zip_ref.extract('document.txt', extract_dir)
    
    # 여러 특정 파일 해제
    files_to_extract = ['file1.txt', 'images/photo.jpg']
    for file in files_to_extract:
        if file in zip_ref.namelist():
            zip_ref.extract(file, extract_dir)
```

### 암호로 보호된 ZIP 파일 해제

```python
import zipfile

zip_path = '/path/to/protected.zip'
extract_dir = '/path/to/extract/folder'
password = 'yourpassword'  # 실제 비밀번호로 변경 필요

try:
    with zipfile.ZipFile(zip_path, 'r') as zip_ref:
        # 비밀번호 설정 (Python 3.6 이하)
        zip_ref.setpassword(password.encode('utf-8'))
        
        # 압축 해제 시도
        zip_ref.extractall(extract_dir)
        print("압축 해제 성공!")
except RuntimeError as e:
    if 'password' in str(e).lower():
        print("오류: 비밀번호가 틀렸거나 필요합니다.")
    else:
        print(f"오류 발생: {e}")
```

### 메모리에서 직접 ZIP 파일 해제 (다운로드 받은 경우 등)

```python
import zipfile
import io
import requests

# 예시: 웹에서 ZIP 파일 다운로드 후 메모리에서 해제
url = 'https://example.com/sample.zip'
response = requests.get(url)
zip_data = io.BytesIO(response.content)

with zipfile.ZipFile(zip_data, 'r') as zip_ref:
    zip_ref.extractall('/path/to/extract/folder')
    print("메모리에서 직접 압축 해제 완료")
```

## 결론

이러한 방법들을 조합하면 Python에서 파일 시스템을 효과적으로 탐색하고 관리할 수 있습니다. `os`와 `pathlib` 모듈은 파일 및 폴더 작업에, `zipfile` 모듈은 압축 파일 작업에 각각 유용합니다. 프로젝트 요구사항에 따라 적절한 방법을 선택하여 사용하시면 됩니다.